!function($){$.jvcBuilder=function(el,options){function tzGetColumnMask(cells){var columns=cells.toString().split("_"),columns_count=columns.length,numbers_sum=0;return cells.length&&(numbers_sum=cells.replace(/([0-9])/gi,"$1+").replace(/_/gi,"").replace(/\+$/gi,""),numbers_sum=eval(numbers_sum)),numbers_sum?columns_count+""+numbers_sum.toString():"custom"}function array_unique(a){a=a.sort(function(a,b){return 1*a-1*b});for(var b=[a[0]],c=1;c<a.length;c++)a[c-1]!==a[c]&&b.push(a[c]);return b}function getInputHiddenData(a){var b=a;if(b||$.layouts.id&&(b=$("[data-model-id="+$.layouts.id+"]")),b&&b.length){"object"!=typeof b&&(b=$(b));var c=b.find("[type=hidden][name*=jform]"),d=[];return c&&c.length&&c.each(function(){var a=$(this).attr("name"),b=a.match(/\[(\w+)\]$/);if(b&&b.length){var c=new Object;c.name=b[b.length-1],c.value=$(this).val(),d.push(c)}}),d}return null}function tzCellString(a){return a&&(a=a.toString(),a=a.replace(/([0-9])/gi,"$1/").replace(/(\/\_)|(\_)/gi," + ").replace(/\/$/gi,"").trim()),a}function tzGcd(a,b){return 0==b?a:tzGcd(b,a%b)}function setDataWAndRToModal(){}function setDataToModal(a,b){a.find("input[data-name],input[name],select[data-name],textarea[data-name]").length&&a.find("input[data-name],select[data-name],textarea[data-name]").each(function(){var a=$(this).data("name").replace(/\-/gi,"_"),c=$(this).prop("tagName").toLowerCase(),d="";if(b.extrafield_data[a]&&(d=b.extrafield_data[a]),b)if("select"===c)$(this).find("option").length&&$(this).find("option").each(function(){$(this).val()===d?$(this).attr("selected","selected"):$(this).attr("selectedIndex",0)});else if("input"===c&&"checkbox"===$(this).attr("type"))$(this).val()===d?$(this).attr("checked","checked"):$(this).removeAttr("checked");else if($(this).val(d),"border_color"===a||"background_color"===a){d.trim().length||(d="rgba(0,0,0,0)"),$(".edit_form_elements [data-extrafield-type=color][data-extrafield-name="+a+"]").spectrum("set",d)}})}function setWidthAndResponsiveToInputHidden(modal,model,selected){var $modal=modal,$model=model;if("object"!=typeof $modal&&($modal=$(modal)),"object"!=typeof $model&&($model=$("[data-model-id="+model+"]")),"tz_column"===$model.data("element_type")){var $namePrefix=$model.find(">input[type=hidden][data-name=tz_name-prefix]").val().replace(/\[/gi,"\\[").replace(/\]/gi,"\\]"),$tagsForm=$modal.find(selected).find("input[data-name]:not([data-name*=tz_hidden],[data-name=width]),select[data-name]:not([data-name*=tz_hidden],[data-name=width])");removeColClass($model,"jvc_col-[a-z]+-offset-|jvc_col-sm-|jvc_col-lg-|jvc_col-md-|jvc_col-xs-");var $colVal=12*eval($modal.find(selected).find("select[data-name=width]").val());$model.addClass("jvc_col-sm-"+$colVal),$tagsForm.length&&$tagsForm.each(function(){$(this).val().length&&$model.addClass($(this).val())})}setGeneralOptionsToInputHidden($modal,$model,selected)}function setGeneralOptionsToInputHidden(a,b,c){var d=a,e=b;"object"!=typeof d&&(d=$(a)),"object"!=typeof e&&(e=$("[data-model-id="+b+"]"));var f=e.find(">input[type=hidden][data-name=tz_name-prefix]").val().replace(/\[/gi,"\\[").replace(/\]/gi,"\\]"),g=d.find(c).find("input[data-name],select[data-name],textarea[data-name]");g.length&&g.each(function(){if($(this).attr("data-name")&&$(this).attr("data-name").length){var a=$(this).attr("data-name").replace(/\[/gi,"\\[").replace(/\]/gi,"\\]"),b=">input[type=hidden][name="+f+"\\["+a+"\\]]",c=e.find(b);c&&c.length&&c.val("checkbox"==$(this).attr("type")||"radio"==$(this).attr("type")?$(this).attr("checked")?$(this).val():"":$(this).val())}})}function setDesignOptionsToInputHidden(a,b){var c=a,d=b;"object"!=typeof c&&(c=$(a)),"object"!=typeof d&&(d=$("[data-model-id="+b+"]"));var e="name=jform\\["+d.data("element_type")+"\\]\\["+$.layouts.id+"\\]",f=c.find("[data-name=background_color]").val(),g=c.find("[data-name=background_image]").val();if(d.find(">input[type=hidden][data-name=tz_name-prefix]")&&(e="name="+d.find(">input[type=hidden][data-name=tz_name-prefix]").val(),e=e.replace(/\[/gi,"\\[").replace(/\]/gi,"\\]")),d.find("> ["+e+"\\[font_color\\]]").val(c.find("[data-name=font-color]").val()),c.find(".tz_css-editor").hasClass("tz_simplified")?(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()&&(d.find("> ["+e+"\\[border_right_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()),d.find("> ["+e+"\\[border_bottom_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()),d.find("> ["+e+"\\[border_left_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()),d.find("> ["+e+"\\[border_color\\]]").val(c.find(".tz_css-editor > .tz_settings [data-name=border_color]").val()),d.find("> ["+e+"\\[border_style\\]]").val(c.find(".tz_css-editor > .tz_settings [data-name=border_style]").val())),d.find("> ["+e+"\\[margin_top\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-top]").val()),d.find("> ["+e+"\\[margin_right\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-top]").val()),d.find("> ["+e+"\\[margin_bottom\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-top]").val()),d.find("> ["+e+"\\[margin_left\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-top]").val()),d.find("> ["+e+"\\[padding_top\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-top]").val()),d.find("> ["+e+"\\[padding_right\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-top]").val()),d.find("> ["+e+"\\[padding_bottom\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-top]").val()),d.find("> ["+e+"\\[padding_left\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-top]").val())):((c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()||c.find(".tz_css-editor > .tz_layout-onion [data-name=border-right-width]").val()||c.find(".tz_css-editor > .tz_layout-onion [data-name=border-bottom-width]").val()||c.find(".tz_css-editor > .tz_layout-onion [data-name=border-left-width]").val())&&(d.find("> ["+e+"\\[border_top_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-top-width]").val()),d.find("> ["+e+"\\[border_right_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-right-width]").val()),d.find("> ["+e+"\\[border_bottom_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-bottom-width]").val()),d.find("> ["+e+"\\[border_left_width\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=border-left-width]").val()),d.find("> ["+e+"\\[border_color\\]]").val(c.find(".tz_css-editor > .tz_settings [data-name=border_color]").val()),d.find("> ["+e+"\\[border_style\\]]").val(c.find(".tz_css-editor > .tz_settings [data-name=border_style]").val())),d.find("> ["+e+"\\[margin_top\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-top]").val()),d.find("> ["+e+"\\[margin_right\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-right]").val()),d.find("> ["+e+"\\[margin_bottom\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-bottom]").val()),d.find("> ["+e+"\\[margin_left\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=margin-left]").val()),d.find("> ["+e+"\\[padding_top\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-top]").val()),d.find("> ["+e+"\\[padding_right\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-right]").val()),d.find("> ["+e+"\\[padding_bottom\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-bottom]").val()),d.find("> ["+e+"\\[padding_left\\]]").val(c.find(".tz_css-editor > .tz_layout-onion [data-name=padding-left]").val())),d.find("> ["+e+"\\[background_color\\]]").val(f),d.find("> ["+e+"\\[background_style\\]]").val(c.find("[data-name=background-style]").val()),g&&g.trim().length)if(g.match(/^http:\/\//i)||g.match(/^www\./i)||(g=$var.rootPath+g),"tz_row"==d.data("element_type")){var h=d.find(">.controls_row > .tz_row_edit_clone_delete");h.find(">.tz_row_image").length?h.find(">.tz_row_image").attr("style","background-image: url("+g+");"):h.find(">.column_toggle").after('<span title="Row background image" style="background-image: url('+g+');" class="tz_row_image"></span>')}else{var h=d.find(">.tz_controls").first();h.find(">.tz_column_image").length?h.find(">.tz_column_image").attr("style","background-image: url("+g+");"):h.find(".column_add").after('<span title="Column background image" style="background-image: url('+g+');" class="tz_column_image"></span>')}else"tz_row"==d.data("element_type")?d.find(">.controls_row > .tz_row_edit_clone_delete > .tz_row_image").remove():d.find(">.tz_controls > .tz_column_image").remove();if(f&&f.trim().length)if("tz_row"==d.data("element_type")){var i=d.find(">.controls_row > .tz_row_edit_clone_delete");i.find(">.tz_row_color").length?i.find(">.tz_row_color").css("background-color",f):i.append('<span data-toggle="jvc_tooltip" title="Row background color" style="background-color: '+f+'" class="tz_row_color"></span>')}else{var i=d.find(">.tz_controls").first();i.find(">.tz_column_color").length?i.find(">.tz_column_color").css("background-color",f):i.prepend('<span data-toggle="jvc_tooltip" title="Column background color" style="background-color: '+f+'" class="tz_column_color"></span>')}else"tz_row"==d.data("element_type")?d.find(">.controls_row > .tz_row_edit_clone_delete > .tz_row_color").remove():d.find(">.tz_controls > .tz_column_color").remove();return d.find("> ["+e+"\\[background_image\\]]").val(g),d}function tzSortable(a){"refresh"==a?$(".container-fluid,.tz_row_container, .tz_column_container:not(.tz_empty-container),.tz_column_container").sortable("refresh"):($(".jscontent_content").sortable({items:"> [data-element_type=tz_column], > [data-element_type=tz_column_inner],> .tz_sortable",handle:".column_move",tolerance:"pointer",distance:.5,revert:!1,placeholder:"tz-row-state-highlight",start:function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide").jvc_tooltip("disable")},stop:function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("enable")}}).find(".tz_column_container").sortable({items:"> [data-element_type]",handle:".column_move, .element-move",connectWith:".jscontent_content .tz_column_container",forceHelperSize:!0,zIndex:9999,revert:200,placeholder:"tz-state-highlight",start:function(a,b){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide").jvc_tooltip("disable");var c=".jscontent_content .tz_column_container";(b.item.is("[data-element-item-count]")||b.item.find("[data-element_type][data-element-item-count]").length)&&(c=".jscontent_content [data-element_type]:not([data-element-item-count])>.element_wrapper >.tz_column_container,.jscontent_content [data-element_type]:not([data-element-item-count]) .tz_column_container.jscontent_element_container"),b.item.parents(".tz_column_container").sortable("option","connectWith",c),$(this).sortable("refresh");var d=b.item.find("> .tz_controls").children();d.removeClass("jvc_btn-group jvc_btn-group-xs").addClass("jvc_btn-group-sm").find(".element-move").removeClass("jvc_btn-sm").removeClass("jvc_btn-xs"),$.jvcBuilder.model.modelRemember=b.item.parents("[data-model-id]").eq(0),b.item.parents("[data-model-id]").eq(0).find("> .element_wrapper").css("overflow","inherit"),b.placeholder.height(b.item.height())},sort:function(a,b){var c=b.item.parent();c.find(">.tz_sortable:not(.ui-sortable-helper)").length||c.find(b.placeholder).length||c.find("> .jvc_fa-plus").length||c.addClass("tz_sorting-empty-container").prepend('<i class="jvc_fa jvc_fa-plus"></i>')},stop:function(a,b){var c=b.item.find("> .tz_controls").children();c.addClass("jvc_btn-group jvc_btn-group-xs").removeClass("jvc_btn-group-sm").find(".element-move").removeClass("jvc_btn-sm").removeClass("jvc_btn-xs"),$.jvcBuilder.model.modelRemember.find("> .element_wrapper").css("overflow",""),"tz_column"!=$.jvcBuilder.model.modelRemember.attr("data-element_type")||$.jvcBuilder.model.modelRemember.find("[data-model-id]").length||$.jvcBuilder.model.modelRemember.addClass("tz_empty-column"),b.item.parents("[data-model-id]").eq(0).find("[data-model-id]").length&&"tz_column"==b.item.parents("[data-model-id]").eq(0).attr("data-element_type")&&b.item.parents("[data-model-id]").eq(0).removeClass("tz_empty-column");var d=b.item.parent();d.find(">.tz_sortable").length?d.removeClass("tz_empty-container fancybox fancybox.iframe").removeAttr("data-toggle").removeAttr("data-target").find("> .jvc_fa.jvc_fa-plus").remove():d.addClass("tz_empty-container fancybox fancybox.iframe").attr("data-toggle","jvc_modal").attr("data-target","#tz_add-shortcode").prepend('<i class="jvc_fa jvc_fa-plus"></i>');var e=$(".tz_sorting-empty-container");if(e.find(">.jvc_fa.jvc_fa-plus").length&&e.addClass("tz_empty-container fancybox fancybox.iframe").attr("data-toggle","jvc_modal").attr("data-target","#tz_add-shortcode"),e.removeClass("tz_sorting-empty-container"),"tz_row"==b.item.data("element_type")){var f=0;b.item.parents("[data-model-id][data-element_type=tz_row]").length&&(f=b.item.parents("[data-model-id][data-element_type=tz_row]").length),f%2==1?b.item.addClass("tz_row-inner"):b.item.removeClass("tz_row-inner")}$.jvcBuilder.mapper&&$.jvcBuilder.mapper[b.item.attr("data-model-id")]&&($.jvcBuilder.mapper[b.item.attr("data-model-id")].parent_id=b.item.parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first().attr("data-model-id")),$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("enable")}}).end().find(".tz_row_container").sortable({items:"> .tz_sortable",revert:200,placeholder:"tz-state-highlight-outer",start:function(a,b){b.placeholder.width(b.item.width()-1).append('<div class="tz-state-highlight"></div>')}}),$(".jscontent_content").find("[data-model-id][data-aria-control]").length&&$(".jscontent_content").find("[data-model-id][data-aria-control]").each(function(){$(this).parents("[data-model-id]").first().parent().sortable({items:">[data-model-id]:not([data-element_type])",forceHelperSize:!0,connectWith:!1,handle:".tz_element-name",placeholder:"tz-state-highlight",tolerance:"pointer",delay:150,revert:200,distance:.5,start:function(a,b){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide").jvc_tooltip("disable");var c=b.item.parents(".ui-sortable").first();if(c.addClass("display").sortable("refresh"),b.item.attr("data-model-id")&&b.item.attr("data-element_type")){var d=b.item.find("> .tz_controls").children();d.removeClass("jvc_btn-group jvc_btn-group-xs").find(".element-move").removeClass("btn-sm").addClass("btn-md"),$.jvcBuilder.model.modelRemember=b.item.parents("[data-model-id]").eq(0),b.item.parents("[data-model-id]").eq(0).find("> .element_wrapper").css("overflow","inherit"),b.placeholder.height(b.item.height())}},stop:function(a,b){var c=b.item.find("[data-model-id][data-aria-control]").first();if(c.attr("data-element-item-count")&&c.attr("data-element-item-count")>1){var d=parseInt(c.attr("data-element-item-count"))-1,e=b.item.parent().find(">[data-model-id]").index(b.item),f=b.item.parents("[data-model-id][data-element_type]").first(),g=c.attr("data-aria-control");d&&d.each(function(a){var b=f.find("[aria-control="+g+"-"+a+"]").first(),c=b.parent(),d=c.children(),h=d.index(b);0==e?c.prepend(b):e==d.length-1?c.append(b):h>d.length/2?d.eq(e).before(b):d.eq(e).after(b)})}if(b.item.attr("data-model-id")&&b.item.attr("data-element_type")){var h=b.item.find("> .tz_controls").children();h.addClass("jvc_btn-group jvc_btn-group-xs").find(".element-move").removeClass("jvc_btn-md").addClass("jvc_btn-sm");var f=b.item.parent();f.find(">.tz_sortable").length?f.removeClass("tz_empty-container fancybox fancybox.iframe").removeAttr("data-toggle").removeAttr("data-target").find("> .jvc_fa.jvc_fa-plus").remove():f.addClass("tz_empty-container fancybox fancybox.iframe").attr("data-toggle","jvc_modal").attr("data-target","#tz_add-shortcode").prepend('<i class="jvc_fa jvc_fa-plus"></i>')}$.jvcBuilder.mapper&&$.jvcBuilder.mapper[b.item.attr("data-model-id")]&&($.jvcBuilder.mapper[b.item.attr("data-model-id")].parent_id=b.item.parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first().attr("data-model-id")),b.item.parents(".ui-sortable").first().removeClass("display"),$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("enable"),$(".jscontent_content").find(".tz_element-column").parents("[data-model-id]").first().parent().sortable("refresh")}})}))}function cloneHtmlInBox(obj){if(obj.find("> [data-model-id][data-element_type]").length){var $childElements=obj.clone(!0).find("> [data-model-id][data-element_type]"),$time=new Date,$_newHtml="",$modelId=obj.parents("[data-model-id]").eq(0).data("model-id");return $childElements.each(function(index,value){var $child=$(this);if($("#tmpl-jscontent-new-element-"+$child.attr("data-element_id")).length){var $id=$.jvcBuilder.createId(obj.parents("[data-model-id]").eq(0).children().length),$data=$.jvcBuilder.getDataHidden($id,$child),$newHtml=getNewHtml($child,obj.parents("[data-model-id]").eq(0),$id,$data);if($newHtml=$.jvcBuilder.setValueExtrafield($newHtml,$data),$child.find("[data-model-id][data-element_type]").first().parent().find("> [data-model-id][data-element_type]").length){var $childElements2=$child.find("[data-model-id][data-element_type]").first().parent().find(">[data-model-id][data-element_type]"),$_newHtml2="";$childElements2.each(function(index,value){var $child2=$(this);if($("#tmpl-jscontent-new-element-"+$child2.attr("data-element_id")).length){var $id2=$.jvcBuilder.createId($child.children().length),$data2=$.jvcBuilder.getDataHidden($id2,$child2),$newHtml2=getNewHtml($child2,$child,$id2,$data2);if($newHtml2=$.jvcBuilder.setValueExtrafield($newHtml2,$data2),$child2.find("[data-model-id][data-element_type]").first().parent().find("> [data-model-id][data-element_type]").length){var $childElements3=$child2.find("[data-model-id][data-element_type]").first().parent().find(">[data-model-id][data-element_type]"),$_newHtml3="",$guid3=guid();$childElements3.each(function(){var $child3=$(this);if($("#tmpl-jscontent-new-element-"+$child3.attr("data-element_id")).length){var $id3=$.jvcBuilder.createId($child2.children().length),$data3=$.jvcBuilder.getDataHidden($id3,$child3),$newHtml3=getNewHtml($child3,$child2,$id3,$data3),$newElHtml3=$("#tmpl-jscontent-new-element-"+$child3.data("element_id")).clone(),$newElObj3=$($newHtml3.html()),$childEls3=$child3.find(">.element_wrapper [data-model-id]").first().parent().find(">[data-model-id]"),$count3=0;if($child3.attr("data-element-item-count")&&($count3=parseInt($child3.attr("data-element-item-count"))),$childEls3.length||($childEls3=$child3),$childEls3.length&&($childEls3.each(function(childIndex3){var $childEl3=$(this),$guid3=guid(),$childId3=$.jvcBuilder.createId($childEls3.length),$childData3=$.jvcBuilder.getDataHidden($childId3,$childEl3);$count3&&$count3.each(function(cIndex){var $newElItemObj3=$("#template-jscontent-new-element-"+$child3.attr("data-element_id")+"-item-"+cIndex).clone(),$newElItemHtml3="";if($newElItemObj3=$.jvcBuilder.createDataModelIds($newElItemObj3),$newElItemHtml3=$newElItemObj3.html(),$newElItemHtml3=$.jvcBuilder.setIDHtml($newElItemHtml3,$childEls3.length,$childId3),$newElItemHtml3=$.jvcBuilder.setValueExtrafield($newElItemHtml3,$childData3),cIndex!=$count3-1)$newElItemHtml3=$newElItemHtml3.replace(/\[modelid\]\[\/modelid\]/gi,$guid3+"-"+cIndex),$newElObj3.find("[aria-control=\\[modelid\\]\\[\\/modelid\\]]").length&&$newElObj3.find("[aria-control=\\[modelid\\]\\[\\/modelid\\]]").first().parent().append($newElItemHtml3);else{$newElItemHtml3=$newElItemHtml3.replace(/\[modelid\]\[\/modelid\]/gi,$guid3);var $newEItemObj3=$($newElItemHtml3).clone();if($childEl3.find("[data-model-id][data-element_type]").length){var $newChildElItem3=cloneHtmlInBox($childEl3.find(".element_wrapper").first().find(">.tz_column_container"));if($newChildElItem3.length){var $childExtrafields3=$newChildElItem3.match(/(\{.*?\})/gim);$childExtrafields3&&$childExtrafields3.length&&$childExtrafields3.each(function(value,exIndex){var regex="/("+value.replace(/\{/,"\\{").replace(/\}/,"\\}")+")/gi";regex=eval(regex),$data[value.replace(/\{/,"").replace(/\}/,"")]&&($newChildElItem3=$newChildElItem3.replace(regex,$data[value.replace(/\{/,"").replace(/\}/,"")]))}),$.jvcBuilder.removeEmptyColumn($newEItemObj3.find(".element_wrapper").first().parent()),$newEItemObj3.find(".element_wrapper").first().find(">.tz_column_container").append($newChildElItem3)}}$newEItemObj3=$.jvcBuilder.createDataModelIds($newEItemObj3),$.jvcBuilder.createInputNameHidden($newEItemObj3.find(".tz_element-column").first(),$child3.parents("[data-model-id]").first(),$childData3),$newElObj3.find("[data-model-id]").first().parent().append($newEItemObj3),childIndex3==$childEls3.length-1&&($newElObj3.find("[aria-control=\\[modelid\\]\\[\\/modelid\\]]").remove(),$newElObj3.find("[data-model-id]").first().parent().find(">[data-model-id]").first().remove())}})}),$newHtml3.html($newElObj3.html())),$newHtml3=$.jvcBuilder.setValueExtrafield($newHtml3,$data3),$child3.find("[data-model-id][data-element_type]").first().parent().find("> [data-model-id][data-element_type]").length){var $childElements4=$child3.find("[data-model-id][data-element_type]").first().parent().find(">[data-model-id][data-element_type]"),$_newHtml4="";$childElements4.each(function(){var a=$(this);if($("#tmpl-jscontent-new-element-"+a.attr("data-element_id")).length){var b=$.jvcBuilder.createId($child3.children().length),c=$.jvcBuilder.getDataHidden(b,a),d=getNewHtml(a,$child3,b,c);if(d=$.jvcBuilder.setValueExtrafield(d,c),a.find("[data-model-id][data-element_type]").first().parent().find("> [data-model-id][data-element_type]").length){var e=a.find("[data-model-id][data-element_type]").first().parent().find(">[data-model-id][data-element_type]"),f="";e.each(function(){var b=$(this);if($("#tmpl-jscontent-new-element-"+b.attr("data-element_id")).length){var c=$.jvcBuilder.createId(a.children().length),d=$.jvcBuilder.getDataHidden(c,b),e=getNewHtml(b,a,c,d);e=$.jvcBuilder.setValueExtrafield(e,d),f+=e.html()}}),f.length&&(d.find(".element_wrapper").last().find(" > .tz_column_container").length?($.jvcBuilder.removeEmptyColumn(d.find(".element_wrapper").last().parent()),d.find(".element_wrapper").last().find(" > .tz_column_container").append(f)):d.find(".element_wrapper").last().find(" > .tz_row_container").length?($.jvcBuilder.removeEmptyColumn(d.find(".element_wrapper").last().parent()),d.find(".element_wrapper").last().find(" > .tz_row_container").append(f)):d.find(".element_wrapper").last().append(f))}$_newHtml4+=d.html()}}),$_newHtml4.length&&($newHtml3.find(".element_wrapper").last().find(" > .tz_column_container").length?($.jvcBuilder.removeEmptyColumn($newHtml3.find(".element_wrapper").last().parent()),$newHtml3.find(".element_wrapper").last().find(" > .tz_column_container").append($_newHtml4)):$newHtml3.find(".element_wrapper").last().find(" > .tz_row_container").length?($.jvcBuilder.removeEmptyColumn($newHtml.find(".element_wrapper").last().parent()),$newHtml3.find(".element_wrapper").last().find(" > .tz_row_container").append($_newHtml4)):$newHtml3.find(".element_wrapper").last().append($_newHtml4))}$_newHtml3+=$newHtml3.html()}}),$_newHtml3.length&&($newHtml2.find(".element_wrapper").last().find(" > .tz_column_container").length?($.jvcBuilder.removeEmptyColumn($newHtml2.find(".element_wrapper").last().parent()),$newHtml2.find(".element_wrapper").last().find(" > .tz_column_container").append($_newHtml3)):$newHtml2.find(".element_wrapper").last().find(" > .tz_row_container").length?($.jvcBuilder.removeEmptyColumn($newHtml2.find(".element_wrapper").last().parent()),$newHtml2.find(".element_wrapper").last().find(" > .tz_row_container").append($_newHtml3)):$newHtml2.find(".element_wrapper").last().append($_newHtml3))}if("tz_row"==$newHtml2.data("element_type")){var $parentCount=0;obj.parents("[data-model-id][data-element_type=tz_row]").length&&($parentCount=obj.parents("[data-model-id][data-element_type=tz_row]").length,$parentCount%2==1&&$newHtml2.addClass("tz_row-inner"))}$_newHtml2+=$newHtml2.html()}}),$_newHtml2.length&&($newHtml.find(".element_wrapper").last().find(" > .tz_column_container").length?($.jvcBuilder.removeEmptyColumn($newHtml.find(".element_wrapper").last().parent()),$newHtml.find(".element_wrapper").last().find(" > .tz_column_container").append($_newHtml2)):$newHtml.find(".element_wrapper").last().find(" > .tz_row_container").length?($.jvcBuilder.removeEmptyColumn($newHtml.find(".element_wrapper").last().parent()),$newHtml.find(".element_wrapper").last().find(" > .tz_row_container").append($_newHtml2)):$newHtml.find(".element_wrapper").last().append($_newHtml2))}if("tz_row"==$newHtml.data("element_type")){var $parentCount=0;obj.parents("[data-model-id][data-element_type=tz_row]").length&&($parentCount=obj.parents("[data-model-id][data-element_type=tz_row]").length,$parentCount%2==1&&$newHtml.addClass("tz_row-inner"))}$_newHtml+=$newHtml.html()}}),$_newHtml}}function getNewHtml(a,b,c,d){if($("#tmpl-jscontent-new-element-"+a.attr("data-element_id")).length){var e=$("#tmpl-jscontent-new-element-"+a.attr("data-element_id")).clone(),f=e.html().trim();if(f.match(/(\[typeid[0-9+]?\].*?\[\/typeid[0-9+]?\])/gim)){var g=f;g=c?$.jvcBuilder.setIDHtml(f):b.length?$.jvcBuilder.setIDHtml(f,b.children().length,c):$.jvcBuilder.setIDHtml(f),f=g.replace(/\[loop\]/,"").replace(/\[\/loop\]/,"")}f.match(/(\[type\].*?\[\/type\])/gim)&&(f=f.replace(/(\[type\].*?\[\/type\])/gim,'<div data-toggle="modal" data-target="#tz_add-shortcode" class="tz_column_container tz_container_for_children tz_empty-container fancybox fancybox.iframe"><i class="jvc_fa jvc_fa-plus"></i></div>'));var h=$("<div></div>").append(f);return b&&b.length&&$.jvcBuilder.createInputNameHidden(h.children(),b,d),h}}function prepare_row(){$this.find("[data-model-id][data-element_type=tz_row]").length&&$this.find("[data-model-id][data-element_type=tz_row]").each(function(){var a=0;$(this).parents("[data-model-id][data-element_type=tz_row]").length&&(a=$(this).parents("[data-model-id][data-element_type=tz_row]").length,a%2==1&&$(this).addClass("tz_row-inner"))})}var $this=$(el),$var=$.extend({},$.jvcBuilder,options),$content_object;$.jvcBuilder.mapper=$.extend({},$.jvcBuilder.mapper,$var.mapper),$.jvcBuilder.head={css:{fields:{},shortcodes:{}},js:{fields:{},shortcodes:{}}},$.jvcBuilder.model.reset(),$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"});var removeColClass=function(column,prefix){var $prefix=prefix,$class=null;if(column&&column.attr("class")&&($class=column.attr("class")),$prefix||($prefix="jvc_col-sm-"),$class.length){var regex="/(("+$prefix+")[0-9]+)/gi";regex=eval(regex),regex.exec($class)&&column.attr("class",$class.replace(regex,""))}return column},resetToEmptyColumn=function(a){var b=a.find("> .element_wrapper .tz_column_container").first();return b.addClass("tz_empty-container fancybox").html('<i class="jvc_fa jvc_fa-plus"></i>'),a.addClass("tz_empty-column"),a};$.jvcBuilder.removeEmptyColumn=function(a){var b=a.find("> .element_wrapper > .tz_column_container");b.hasClass("tz_empty-container")&&b.removeClass("tz_empty-container fancybox").removeAttr("data-toggle").removeAttr("data-target").html("")},$.removeLayoutItem=function(a){var b=$(a).parents("[data-model-id]"),c=b.first(),d=!1;if("tz_column"==c.data("element_type")&&"tz_row"==c.parents("[data-model-id]").first().data("element_type")&&c.parent().find("> [data-model-id][data-element_type=tz_column]").length<=1)return void alert("Can not delete last section");if(d||(d=confirm("Press OK to delete section, Cancel to leave")),d){var e=c.parents("[data-model-id]").first();$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide"),$.jvcBuilder.remove_mapper_item(c),c.remove(),e.find("[data-model-id]").length||resetToEmptyColumn(e),$.setActiveLayoutButton()}return $(a)},$.jvcBuilder.createId=function(a,b){var c=new Date,d=c.getTime(),e="";return e=b?b+"-"+d+"-"+a+"-"+parseInt(d%a):d+"-"+a+"-"+d%a};var $typeids={};$.jvcBuilder.setIDHtml=function(html,count,id,prefix,parentid,mindex){var $id=id;if(("undefined"==typeof mindex||"undefined"!=typeof mindex&&0==mindex)&&($typeids={}),html){var $html=html,$model=$.jvcBuilder.model.get_model(),$parentids;if($model&&(parentid&&($parentids=$.jvcBuilder.mapper[$model.attr("data-model-id")].parentids),$model.attr("data-aria-control")&&$model.attr("data-aria-control").length)){var $parent_model=$model.parents("[data-model-id][data-element_type]").first();$parentids=$.jvcBuilder.mapper[$parent_model.attr("data-model-id")].parentids}if($html.match(/(\[parentid[0-9+]?\].*?\[\/parentid[0-9+]?\])/gim)){var $matches=$html.match(/(\[parentid[0-9+]?\].*?\[\/parentid[0-9+]?\])/gim);$.each($matches,function(index,value){var regex="/"+tzaddslashes(value)+"/gi";regex=eval(regex),regex.exec($html)&&($html=$html.replace(regex,$parentids[value]),$parentids&&($html=$html.replace(regex,$parentids[value])))})}else if($html.match(/(\[\/parentid[0-9+]?\])/gim)){var $matches=$html.match(/(\[\/parentid[0-9+]?\])/gim);$.each($matches,function(index,value){var regex="/"+tzaddslashes(value)+"/gi";regex=eval(regex),regex.exec($html)&&$parentids&&($html=$html.replace(regex,$parentids[value]))})}if($html.match(/(\[typeid[0-9+]?\].*?\[\/typeid[0-9+]?\])/gim)){var $matches=html.match(/(\[typeid[0-9+]?\].*?\[\/typeid[0-9+]?\])/gim);return $matches.length&&$matches.each(function(value,index){var regex="/"+tzaddslashes(value)+"/gi",d=new Date,$time=d.getTime();regex=eval(regex),regex.exec($html)&&($html=$html.replace(regex,$time+"-"+count+"-"+index))}),$html}if($html.match(/(\[\/typeid[0-9+]?\])/gim)){var $matches=html.match(/(\[\/typeid[0-9+]?\])/gim);if($matches.length)return $matches=array_unique($matches),$matches.each(function(value,index){var d=new Date,$time=d.getTime();$time+="-"+count+"-"+index,"undefined"==typeof $typeids[value.toString()]&&($typeids[value.toString()]=$time);var regex="/"+tzaddslashes(value)+"/gi";regex=eval(regex),regex.exec($html)&&($html=$html.replace(regex,$typeids[value]))}),$html}}return html},$.jvcBuilder.createInputNameHidden=function(a,b,c,d){var e=a;if(e.find("input[type=hidden]").length){var f="jform[attrib]";b&&b.find("> input[type=hidden][data-name=tz_name-prefix]").length&&(f=b.find("> input[type=hidden][data-name=tz_name-prefix]").val()+"[children]");var g;if(f+="["+e.data("model-id")+"]",e.find("> input[type=hidden][name]").each(function(a,b){if($(this).attr("name").match(/(\[\w+(\-)?\w+\])/gi)){var d=$(this),e=$(b).attr("name"),h=e.match(/(\[\w+(\-)?\w+\])/gi);h.length&&($(this).attr("name",function(a,b){return b.match(/\[\]$/i)?b.replace(/^jform\[.*?\]\[\]$/gi,f+h[h.length-1]+"[]"):b.replace(/^jform\[.*?\]$/gi,f+h[h.length-1])}),$(this).attr("name").match(/\[element_type\]$/gi)||$(this).attr("name").match(/\[typeid\]$/gi)||c&&(g=c[h[h.length-1].replace(/\[/,"").replace(/\]/,"")],g?$.isArray(g)?g.each(function(a,b){if(0===b)d.val(a);else{var c=d.clone(!0);c.val(a),d.after(c)}}):$(this).val(c[h[h.length-1].replace(/\[/,"").replace(/\]/,"")]):$(this).val("")))}}),e.find(">input[type=hidden][data-name=tz_name-prefix]").length&&e.find(">input[type=hidden][data-name=tz_name-prefix]").val(f),b){if(e.find(">input[type=hidden][name="+tzaddslashes(f)+"\\[parent\\]]").length){var h=b.find("> input[type=hidden][data-name=tz_name-prefix]").val();if(h){var i=h.match(/\[\w+\-\w+\]$/);e.find(">input[type=hidden][name="+tzaddslashes(f)+"\\[parent\\]]").val(i[0].replace(/\[|\]/g,""))}}}else e.find(">input[type=hidden][name="+tzaddslashes(f)+"\\[parent\\]]").val("");return!d&&a.find(">input[type=hidden][name]").length&&a.find(">.element_wrapper input[type=hidden][data-name=tz_name-prefix]").length&&$.jvcBuilder.createInputNameHidden(a.find(">.element_wrapper input[type=hidden][data-name=tz_name-prefix]").first().parent(),e,c),e
}return null},$.setActiveLayoutButton=function(a){var b=a,c=$.jvcBuilder.model.get_model();if(c){a||(b=a=$.map(c.find(">.element_wrapper >.tz_row_container > .tz_column"),function(a){var b=$(a).attr("data-width");return b?b.replace(/\//,"").replace(/\s+/,""):"11"}).join("_"),b||(b="custom")),c.find("> .controls .tz_active").removeClass("tz_active");var d=c.find("> .controls [data-cells-mask="+tzGetColumnMask(a.toString())+"][data-cells="+b+"]");d.length?d.addClass("tz_active"):c.find("> .controls [data-cells-mask=custom]").addClass("tz_active")}else $this.find("[data-model-id][data-element_type=tz_row]").length&&$this.find("[data-model-id][data-element_type=tz_row]").each(function(){b=null;var a=$(this);b=$.map(a.find(">.element_wrapper >.tz_row_container > .tz_column"),function(a){var b=$(a).attr("data-width");return b?b.replace(/\//,"").replace(/\s+/,""):"11"}).join("_"),b||(b="custom"),a.find("> .controls .tz_active").removeClass("tz_active");var c=a.find("> .controls [data-cells-mask="+tzGetColumnMask(b.toString())+"][data-cells="+b+"]");c.length?c.addClass("tz_active"):a.find("> .controls [data-cells-mask=custom]").addClass("tz_active")})},$.setLayoutColumn=function(column_layout){if(column_layout=column_layout.toString().trim().replace(/\'|\"|\(|\)|\{|\}|\[|\]|\!|\.|\;|\~/gi,""),!column_layout.toString().trim().length||column_layout.toString().trim().length&&!column_layout.toString().trim().match(/(^[0-9]+)\/?|(^span)/gi))return alert("Wrong row layout format! Example: 1/2 + 1/2 or span6 + span6."),!1;var $column_layout=column_layout,$columns=$.jvcBuilder.model.get_model().find("> .element_wrapper > .tz_row_container > .tz_column");if($column_layout=$column_layout&&$column_layout.toString().match(/_/)?$column_layout.split("_"):$.makeArray($column_layout.toString()),$column_layout.length){var $cols=[1,2,3,4,5,6,7,8,9,10,11,12],colAccept=!0;$column_layout=$.map($column_layout,function(col,index){if(col.toString().trim().match(/span/gi)){col=col.replace(/span/gi,"");var colvar=col.replace(/span/gi,"");return-1==$($cols).index(parseInt(colvar))?void(colAccept=!1):col/tzGcd(col,12)+""+12/tzGcd(col,12)}var colvar=12*eval(col.toString().replace(/([0-9])/gi,"$1/").replace(/\/$/gi,""));return-1==$($cols).index(colvar)?void(colAccept=!1):col})}if(colAccept||alert("Wrong row layout format! Example: 1/2 + 1/2 or span6 + span6."),$columns.length>$column_layout.length){var indexNotEmpty=0;$.each($columns,function(index,obj){var $data={};if($column_layout&&$column_layout[index]){$data.width=$column_layout[index].replace(/([0-9])/gi,"$1/").replace(/\/$/gi,""),$data.element_type="tz_column",indexNotEmpty=index;var $colVal=12*eval($column_layout[index].replace(/([0-9])/i,"$1/").replace(/\/$/gi,""));removeColClass($(this)),$(this).addClass("jvc_col-sm-"+$colVal).attr("data-width",$column_layout[index].replace(/([0-9])/gi,"$1/").replace(/\/$/gi,"")),$.jvcBuilder.edit_param_mapper_item("width",$(this).attr("data-width"),$(this))}else{if(!$(this).find(">.element_wrapper >.tz_column_container").hasClass("tz_empty-container")){var $prevColumn=$columns.eq(indexNotEmpty);$.jvcBuilder.removeEmptyColumn($prevColumn),$prevColumn.find(">.element_wrapper >.tz_column_container").append($(this).find(">.element_wrapper >.tz_column_container").html())}$.jvcBuilder.remove_mapper_item($(this)),$(this).remove()}})}else $.each($column_layout,function(index,value){var $data={};$data.width=value.replace(/([0-9])/gi,"$1/").replace(/\/$/gi,""),$data.element_type="tz_column";var $colVal=12*eval(value.replace(/([0-9])/i,"$1/"));if($columns.eq(index).length)removeColClass($columns.eq(index)),$columns.eq(index).addClass("jvc_col-sm-"+$colVal).attr("data-width",value.replace(/([0-9])/gi,"$1/").replace(/\/$/gi,"")),$.jvcBuilder.edit_param_mapper_item("width",$columns.eq(index).attr("data-width"),$columns.eq(index));else{var $newColumn=$($("#tmpl-jscontent-new-element-column").html()).clone(!0);removeColClass($newColumn),$newColumn.addClass("jvc_col-sm-"+$colVal),$newColumn=$.jvcBuilder.createDataModelIds($newColumn);var $_newColumn=$newColumn.clone(!0);$columns.eq($columns.length-1).parent().append($_newColumn);var $params={params:{background_color:"",background_image:"",background_style:"",border_color:"",border_style:"",font_color:"",el_class:"",margin_top:"",margin_right:"",margin_bottom:"",margin_left:"",padding_top:"",padding_right:"",padding_bottom:"",padding_left:"",border_top_width:"",border_right_width:"",border_bottom_width:"",border_left_width:"",width:value.replace(/([0-9])/gi,"$1/").replace(/\/$/gi,""),col_lg_size:"",col_md_size:"",col_xs_size:"",col_lg_offset:"",col_md_offset:"",col_sm_offset:"",col_xs_offset:"",hidden_xs:"",hidden_sm:"",hidden_md:"",hidden_lg:""}};$.jvcBuilder.insert_mapper_item($_newColumn,!1,$columns.eq($columns.length-1).parents("[data-model-id][data-element_type]").first(),$params)}});$.setActiveLayoutButton($column_layout.join("_"))},$.jvcBuilder.insert_mapper_item=function(a,b,c,d,e){var f="",g="",h="",i="",j="",k="";if(a&&(g="tz_element",a.attr("data-element_type")&&(g=a.attr("data-element_type"))),b){f=b.parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first();var l={};b.attr("data-element_type")&&("tz_row"==b.attr("data-element_type")?f=b:h=f.attr("data-element_id")),b.attr("data-aria-control")&&(f=b.parents("[data-model-id][data-element_type]").first(),h=f.attr("data-element_id")),(!f||f&&!f.length)&&c&&(f=c),$.jvcBuilder.mapper[b.attr("data-model-id")]&&(l=$.jvcBuilder.mapper[b.attr("data-model-id")],g=l.name,i=$.extend(!0,{},l.params),j=l.shortcode)}c&&(f=c),a.attr("data-element_id")&&(h=a.attr("data-element_id")),d?(d.params&&(i=$.extend(!0,{},d.params)),d.element_id&&(h=d.element_id),e&&i&&$.each(i,function(a){i[a]=""})):f&&f.attr("data-element_type")&&"tz_row"==f.attr("data-element_type")&&(i={background_color:"",background_image:"",background_style:"",border_color:"",border_style:"",font_color:"",el_class:"",margin_top:"",margin_right:"",margin_bottom:"",margin_left:"",padding_top:"",padding_right:"",padding_bottom:"",padding_left:"",border_top_width:"",border_right_width:"",border_bottom_width:"",border_left_width:"",width:"1/1",col_lg_offset:"",col_md_offset:"",col_sm_offset:"",col_xs_offset:""}),j=g&&"tz_element"==g?"{tz_element }{/tz_element}":"["+g+" ][/"+g+"]",f&&f.attr("data-model-id")&&(k=f.attr("data-model-id")),$.jvcBuilder.mapper[a.attr("data-model-id")]={id:a.attr("data-model-id"),name:g,element_id:h,parent_id:k,params:i,parentids:{},shortcode:j}},$.jvcBuilder.edit_param_mapper_item=function(a,b,c){var d=c;if(c||(d=$.jvcBuilder.model.get_model()),$.jvcBuilder.mapper[d.attr("data-model-id")]){var e=$.jvcBuilder.mapper[d.attr("data-model-id")];e.params[a]||(e.params[a]=""),e.params[a]=b,$.jvcBuilder.mapper[d.attr("data-model-id")]=e}},$.jvcBuilder.edit_params_mapper_item=function(a,b){var c=b,d=a;if(b||(c=$.jvcBuilder.model.get_model()),"object"==typeof a&&(d.params||(d.params=a.options),$.jvcBuilder.mapper[c.attr("data-model-id")])){var e=$.jvcBuilder.mapper[c.attr("data-model-id")].params;Object.keys(d.params).length>=Object.keys(e).length?$.each(d.params,function(a){a&&a.length&&($.jvcBuilder.mapper[c.attr("data-model-id")].params[a]=d.params[a]?d.params[a].trim():"")}):$.each(e,function(a){a&&a.length&&($.jvcBuilder.mapper[c.attr("data-model-id")].params[a]=d.params[a]?d.params[a].trim():"")})}},$.jvcBuilder.addCss=function(a){a.length&&$("head style").length&&$("head style").last().append(a)},$.jvcBuilder.remove_mapper_item=function(a){var b=!1,c=a;return a||$.jvcBuilder.model.get("id")&&(c=$.jvcBuilder.model.get_model()),c&&$.jvcBuilder.mapper&&$.jvcBuilder.mapper[c.attr("data-model-id")]&&(c.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").length&&c.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").each(function(){b=delete $.jvcBuilder.mapper[$(this).attr("data-model-id")]}),b=delete $.jvcBuilder.mapper[c.attr("data-model-id")]),$.jvcBuilder.mapper},$.addShortCodeElementTemp=function(a){var b=$("<div></div>").append(a);b.find("script[id]").length&&b.find("script[id]").each(function(){$("head").find("#"+$(this).attr("id")).remove()}),$("head").append(a)},$.addShortCodeElement=function(a,b,c,d,e){var f=null;if($.jvcBuilder.model.id&&(f=$.jvcBuilder.model.get_model()),f){if(f.length&&b.length){var g=$(b);if(f.find(">.element_wrapper > .tz_column_container").length?f.find(">.element_wrapper > .tz_column_container").removeClass("tz_empty-container fancybox fancybox.iframe").removeAttr("data-toggle").removeAttr("data-target").end().removeClass("tz_empty-column").find(">.element_wrapper > .tz_column_container >.jvc_fa-plus").remove():f.find(">.element_wrapper .tz_column_container").first().find(">.jvc_fa-plus").length&&f.find(">.element_wrapper .tz_column_container").first().removeClass("tz_empty-container fancybox fancybox.iframe").removeAttr("data-toggle").removeAttr("data-target").find(">.jvc_fa-plus").remove(),"tz_row"==g.data("element_type")){var h=0;f.parents("[data-model-id][data-element_type=tz_row]").length&&(h=f.parents("[data-model-id][data-element_type=tz_row]").length,h%2==1&&g.addClass("tz_row-inner"))}"bottom"==$.jvcBuilder.model.get("toolbar_position")?(f.find(">.element_wrapper .tz_column_container").first().append(g),$.jvcBuilder.model.set("toolbar_position","")):f.find(">.element_wrapper .tz_column_container").length?f.find(">.element_wrapper .tz_column_container").first().prepend(g):f.append(g)}}else $this.find("#tz_no-content-helper_"+$var.name).before(b);!c||"object"!=typeof c&&"array"!=typeof c||$.each(c,function(a,b){$.jvcBuilder.model.id&&"tz_element"!=b.name&&"tz_column"!=b.name&&(b.parent_id=$.jvcBuilder.model.id),$.jvcBuilder.mapper[a]=b}),e&&Object.keys(e).length&&(e.css.shortcodes&&Object.keys(e.css.shortcodes).length&&$.each(e.css.shortcodes,function(a,b){$.jvcBuilder.head.css.shortcodes[a]=b}),e.css.fields&&Object.keys(e.css.fields).length&&$.each(e.css.fields,function(a,b){$.jvcBuilder.head.css.fields[a]=b}),e.js.shortcodes&&Object.keys(e.js.shortcodes).length&&$.each(e.js.shortcodes,function(a,b){$.jvcBuilder.head.js.shortcodes[a]=b}));var i="",j="";$.jvcBuilder.head.css.fields&&Object.keys($.jvcBuilder.head.css.fields).length&&$.each($.jvcBuilder.head.css.fields,function(a,b){i+=b}),$.jvcBuilder.head.css.shortcodes&&Object.keys($.jvcBuilder.head.css.shortcodes).length&&$.each($.jvcBuilder.head.css.shortcodes,function(a,b){i+=b}),$.jvcBuilder.head.js.shortcodes&&Object.keys($.jvcBuilder.head.js.shortcodes).length&&$.each($.jvcBuilder.head.js.shortcodes,function(a,b){j+=b}),i.length&&($("head style[id=jvc_style_"+$var.name+"]").length?$("head style[id=jvc_style_"+$var.name+"]").empty().append(i):$("head").append('<style type="text/css" id="jvc_style_'+$var.name+'">'+i+"</style>")),new $.jvcBuilder($this,$var)},$(".tz_shortcode-layout > .tz_modal").draggable({handle:".tz_modal-header",start:function(a,b){b.helper.width(b.helper.width())}}),new tzSortable,$this.undelegate("[data-dismiss=jvc_alert]","click.bs.jvc_alert.data-api").delegate("[data-dismiss=jvc_alert]","click.bs.jvc_alert.data-api",function(){return!1}),$this.undelegate("[data-model-id][data-element_type=tz_row] > .controls_row .column_toggle","click.bs.jvc_collapse.data-api").delegate("[data-model-id][data-element_type=tz_row] > .controls_row .column_toggle","click.bs.jvc_collapse.data-api",function(){var a,b=$(this),c=b.attr("data-target")||(a=b.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"");c=$(c);var d=c.data("bs.jvc_collapse");d&&"object"==typeof d?d.$element.hasClass("jvc_in")?b.removeClass("jvc_collapsed").addClass("jvc_collapsed"):b.removeClass("jvc_collapsed"):b.removeClass("jvc_collapsed").addClass("jvc_collapsed")}),$this.undelegate(".column_add,.tz_empty-container","click").delegate(".column_add,.tz_empty-container","click",function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"});var a=$(this).parents("[data-model-id]").first(),b=$var.createDataModelIds($("#tmpl-jscontent-new-element-column").clone(!0).html());$.jvcBuilder.model.set("id",a.attr("data-model-id")),a.find(".jvc_panel-collapse").first().hasClass("jvc_in")||a.find(".jvc_panel-collapse").first().parents("[data-model-id][data-element_type=tz_row]").first().find(".jvc_panel-collapse").jvc_collapse("show").end().find("[data-toggle=jvc_collapse]").removeClass("jvc_collapsed"),$(this).parent().hasClass("bottom-controls")&&$.jvcBuilder.model.set("toolbar_position","bottom"),"tz_row"==$(this).parents("[data-model-id]").eq(0).data("element_type")&&($.jvcBuilder.insert_mapper_item(b,!1,a),a.find(">.element_wrapper >.tz_row_container").append(b),$.setActiveLayoutButton(),$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"})),$(this).hasClass(".column_add")&&new $.jvcBuilder($this,$var)}),$this.undelegate(".column_clone","click").delegate(".column_clone","click",function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"});var a=$(this).parents("[data-model-id]").first(),b=($("<div></div>").append(a.clone(!0)),$($(this).parents("[data-model-id]").first()).jscontent_htmlTree({jvcBuilder:$.jvcBuilder}));b.length&&a.after($(b)),new $.jvcBuilder($this,$var)}),$this.undelegate(".column_edit","click").delegate(".column_edit","click",function(){var a=$(this).parents("[data-model-id][data-element_type]").first();$.jvcBuilder.model.set("id",a.attr("data-model-id"))}),$this.undelegate(".column_delete","click").delegate(".column_delete","click",function(){$.jvcBuilder.model.set("id",$(this).parents("[data-model-id]").eq(1).data("model-id")),$.removeLayoutItem(this)}),$this.undelegate(".tz_control-set-column[data-cells=custom]","click").delegate(".tz_control-set-column[data-cells=custom]","click",function(){var a=$(this).parents("[data-model-id][data-element_type]").first();$.jvcBuilder.model.set("id",a.data("model-id")),$("#tz_row-layout").val(tzCellString($(this).parent().find(".tz_active").data("cells")))}),$this.undelegate(".tz_control-set-column:not([data-cells=custom])","click").delegate(".tz_control-set-column:not([data-cells=custom])","click",function(){var a=$(this).parents("[data-model-id][data-element_type]").first();a.find(".jvc_panel-collapse").jvc_collapse("show").end().find("[data-toggle=jvc_collapse]").removeClass("jvc_collapsed"),$.jvcBuilder.model.set("id",a.attr("data-model-id")),$.setLayoutColumn($(this).data("cells")),$.jvcBuilder.model.reset(),new $.jvcBuilder($this,$var)}),$(".jscontent_options .tz_layout-btn").die("click").live("click",function(){$.setLayoutColumn($(this).data("cells")),$.fancybox.close()}),$("#tz_row-layout-update").die("click").live("click",function(){if(!$("#tz_row-layout").val().length)return alert("Wrong row layout format! Example: 1/2 + 1/2 or span6 + span6."),!1;var a=$("#tz_row-layout").val().replace(/\+/gi,"_").replace(/\/|\s/gi,"");return $.setLayoutColumn(a)?void $.fancybox.close():(alert("Wrong row layout format! Example: 1/2 + 1/2 or span6 + span6."),!1)}),$this.undelegate(".tz_panel-btn-save","click").delegate(".tz_panel-btn-save","click",function(){var a=$(this).parents(".tz_modal").eq(0),b=$("[data-model-id="+$.jvcBuilder.model.id+"]");setDesignOptionsToInputHidden(a,b),setGeneralOptionsToInputHidden(a,b,"#tz_edit-form-row-tab-0"),setWidthAndResponsiveToInputHidden(a,b,"#tz_edit-form-column-tab-2"),a.modal("hide")}),$.editExtrafield=function(a){var b=$.jvcBuilder.model.get_model(),c=b.parents("[data-model-id][data-element_type]").first(),d=(guid(),c.data("element_id")),e=$.jvcBuilder.createId(b.parent().find(">[data-model-id]").length),f=0;b.attr("data-element-item-count")&&(f=b.attr("data-element-item-count"),f=parseInt(f));var g={};if("object"!=typeof a?a.length&&(g=$.parseJSON(a)):g=a,f)if(b.attr("data-aria-control"))f.each(function(a){var h=$("#template-jscontent-new-element-"+d+"-item-"+a).clone();if(h.length){var i=h.html();if(i=$.jvcBuilder.setIDHtml(i,c.parent().find(">[data-model-id]").length,e,null,null,a),i=$.jvcBuilder.setValueExtrafield(i,g.params),a!=f-1){if(c.find("[aria-control]").length&&c.find("[aria-control]").parent().length){i=i.replace(/\[modelid\]\[\/modelid\]/gi,b.attr("data-aria-control")+"-"+a);var j=$(i);j.attr("data-model-id")&&(j=$var.createDataModelIds(j,!0)),c.find("[aria-control="+b.attr("data-aria-control")+"-"+a+"]").after(j).remove()}}else{i=i.replace(/\[modelid\]\[\/modelid\]/gi,b.attr("data-aria-control"));var j=$(i);j=$.jvcBuilder.createDataModelIds(j,!0),$.jvcBuilder.edit_params_mapper_item(g),b.find(">.element_wrapper").children().length&&b.find(">.element_wrapper [data-model-id][data-element_type]").length&&j.find(".element_wrapper").empty().append(b.find(">.element_wrapper").children().clone(!0)),b.attr("data-element_type")?b.after(j):b.parents("[data-model-id]").first().after(j).remove()}}});else{var h=$("#tmpl-jscontent-new-element-"+b.attr("data-element_id")).clone(!0);if(h.length){var i=h.html();i=$.jvcBuilder.setValueExtrafield(i,g.params);var j=$.jvcBuilder.createDataModelIds(i,!0);$.jvcBuilder.edit_params_mapper_item(g),b.find(">.element_wrapper").children().length&&b.find(">.element_wrapper [data-model-id][data-element_type]").length&&(j.removeClass("tz_empty-column"),j.find(".element_wrapper").empty().append(b.find(">.element_wrapper").children())),"column"==b.attr("data-element_id")&&$.setActiveLayoutButton(),b.find("[data-model-id][data-aria-control]").length&&(b.find("[data-model-id][data-aria-control]").each(function(){f&&f>1&&j.find("[aria-control=\\[modelid\\]\\[\\/modelid\\]]").first().parent().append(b.find("[aria-control="+$(this).attr("data-aria-control")+"-0]")),j.find("[data-aria-control]").first().parents("[data-model-id]").first().parent().append($(this).parents("[data-model-id]").first())}),j.find("[data-aria-control=\\[modelid\\]\\[\\/modelid\\]]").parents("[data-model-id]").first().remove(),j.find("[aria-control=\\[modelid\\]\\[\\/modelid\\]]").first().remove()),b.after(j).remove()}}else{var h=$("#tmpl-jscontent-new-element-"+b.attr("data-element_id")).clone();if(h.length){var i=h.html();i=$.jvcBuilder.setValueExtrafield(i,g.params);var j=$.jvcBuilder.createDataModelIds(i,!0);if("tz_row"==b.attr("data-element_type")){var k=0;b.parents("[data-model-id][data-element_type=tz_row]").length&&(k=b.parents("[data-model-id][data-element_type=tz_row]").length,k%2==1&&j.addClass("tz_row-inner"))}$.jvcBuilder.edit_params_mapper_item(g),b.find(">.element_wrapper").children().length&&b.find(">.element_wrapper [data-model-id][data-element_type]").length&&(j.removeClass("tz_empty-column"),j.find(".element_wrapper").empty().append(b.find(">.element_wrapper").children())),"column"==b.attr("data-element_id")&&$.setActiveLayoutButton(),b.after(j).remove()}}new $.jvcBuilder($this,$var)},$this.undelegate(".tz_element-btn-save","click").delegate(".tz_element-btn-save","click",function(){var a=$(this).parents(".tz_modal").eq(0);a.find(".tz_modal-body >iframe").contents().find("form").submit().end().end().one("load",function(){"none"!=a.css("display")&&a.modal("hide")})}),$.jvcBuilder.setValueExtrafield=function(html,data){if(html){var $extrafields=[];$extrafields="object"==typeof html?html.html().match(/(\{.*?\})/gim):html.match(/(\{.*?\})/gim),$extrafields&&$extrafields.length&&$extrafields.each(function(value,exIndex){var regex="/("+value.replace(/\{/,"\\{").replace(/\}/,"\\}")+")/gi";regex=eval(regex);var $data="";if(data&&data[value.replace(/\{/,"").replace(/\}/,"")]&&($data=" "+data[value.replace(/\{/,"").replace(/\}/,"")]+" ","editor"!=value.replace(/\{/,"").replace(/\}/,"")&&($data=" "+html_entity_decode($data.trim())+" ",$data=stripslashes($data),$data=$data.replace(/\&nbsp\;/gm," "))),$data&&($.isArray($data)&&($data=$data.join(" ")),$data=$data.trim(),$data.length))if("object"==typeof html){html.html(html.html().replace(regex,$data));var _reg=/(\<img.*?src=[\"|\'](\s+?[^http]+.*?)[\"|\'].*?\/?\>)/g;html.html().match(/(\<img.*?src=[\"|\'])(\s+?[^http]+.*?)([\"|\'].*?\/?\>)/gm)&&html.html(html.html().replace(/(\<img.*?src=[\"|\'])(\s+?)([^http]+.*?)([\"|\'].*?\/?\>)/gm,"$1"+$var.rootPath+"$3".trim()+"$4"))}else{html=html.replace(regex,$data);var _reg=/(\<img.*?src=[\"|\'](\s+?[^http]+.*?)[\"|\'].*?\/?\>)/g;html.match(/(\<img.*?src=[\"|\'])(\s+)?([^http]+.*?)([\"|\'].*?\/?\>)/gm)&&(html=html.replace(/(\<img.*?src=[\"|\'])(\s+)?([^http]+.*?)([\"|\'].*?\/?\>)/gm,"$1"+$var.rootPath+"$3$4"))}});var $html=html;if("object"!=typeof $html&&($html=$(html)),"tz_row"==$html.attr("data-element_type")||"tz_column"===$html.attr("data-element_type")){var $backgroundColor=data.background_color,$backgroundImage=data.background_image;if($backgroundImage&&$backgroundImage.trim().length)if($backgroundImage.match(/^http:\/\//i)||$backgroundImage.match(/^www\./i)||($backgroundImage=$var.rootPath+$backgroundImage),"tz_row"==$html.data("element_type")){var $rowEditClone2=$html.find(">.controls_row > .tz_row_edit_clone_delete");$rowEditClone2.find(">.tz_row_image").length?$rowEditClone2.find(">.tz_row_image").css("background-image",$backgroundImage):$rowEditClone2.append('<span data-toggle="jvc_tooltip" title="Row background image" style="background-image: url('+$backgroundImage+');" class="tz_row_image"></span>')}else{var $rowEditClone2=$html.find(">.tz_controls").first();$rowEditClone2.find(">.tz_column_image").length?$rowEditClone2.find(">.tz_column_image").css("background-image",$backgroundColor):$rowEditClone2.prepend('<span data-toggle="jvc_tooltip" title="Column background image" style="background-image: url('+$backgroundImage+');" class="tz_column_image"></span>')}else"tz_row"==$html.data("element_type")?$html.find(">.controls_row > .tz_row_edit_clone_delete > .tz_row_image").remove():$html.find(">.tz_controls > .tz_column_image").remove();if($backgroundColor&&$backgroundColor.trim().length)if("tz_row"==$html.data("element_type")){var $rowEditClone=$html.find(">.controls_row > .tz_row_edit_clone_delete");$rowEditClone.find(">.tz_row_color").length?$rowEditClone.find(">.tz_row_color").css("background-color",$backgroundColor):$rowEditClone.find(".column_toggle").after('<span data-toggle="jvc_tooltip" title="Row background color" style="background-color: '+$backgroundColor+'" class="tz_row_color"></span>')}else{var $rowEditClone=$html.find(">.tz_controls").first();$rowEditClone.find(">.tz_column_color").length?$rowEditClone.find(">.tz_column_color").css("background-color",$backgroundColor):$rowEditClone.find(".column_add").before('<span data-toggle="jvc_tooltip" title="Column background color" style="background-color: '+$backgroundColor+'" class="tz_column_color"></span>')}else"tz_row"==$html.data("element_type")?$html.find(">.controls_row > .tz_row_edit_clone_delete > .tz_row_color").remove():$html.find(">.tz_controls > .tz_column_color").remove();if("tz_column"===$html.attr("data-element_type")){var $classKeys=["tz_col_lg_size","tz_col_md_size","tz_col_xs_size","tz_lg_offset_size","tz_md_offset_size","tz_sm_offset_size","tz_xs_offset_size"],$class=$.map(data,function(value,key){if("width"===key){var $colVal=12*eval(value);return $html.attr("data-width",value),"jvc_col-sm-"+$colVal}return-1!=$.inArray(key,$classKeys)&&value.length?value:void 0});$html.addClass($class.join(" "))}html="object"==typeof html?$html:$html[0]}}return html},$.jvcBuilder.getDataHidden=function(a,b,c){var d=b;$.jvcBuilder.model.id&&(d=$("[data-model-id="+$.jvcBuilder.model.id+"]")),b&&(d="object"!=typeof b?$(b):b);var e={},f=d.find("> [type=hidden][name]");return d.find(".tz_element-column[data-model-id]").length&&!c&&(f=d.find(".tz_element-column[data-model-id]").first().find("> [type=hidden][name]")),f.each(function(){var a=$(this).attr("name"),b=a.match(/\[\w+(\-)?\w+\]/gi);b=b[b.length-1],b=b.replace(/\[/,"").replace(/\]/,""),a.match(/\[\]$/gi)?((!e[b]||e[b]&&!$.isArray(e[b]))&&(e[b]=new Array),e[b].push($(this).val())):e[b]=$(this).val()}),a&&e.typeid&&(e.typeid=a),e},$this.undelegate("#tz_no-content-helper_"+$var.name,"click").delegate("#tz_no-content-helper_"+$var.name,"click",function(){$.jvcBuilder.model.set("id","")}),$this.undelegate(".tz_control-btn-prepend","click").delegate(".tz_control-btn-prepend","click",function(){$.jvcBuilder.model.set("id",$(this).parents("[data-model-id]").eq(0).data("model-id"));var a=$("#tz_add-shortcode");a.find(".tz_modal-body >iframe").attr("src",function(a,b){return b.match(/tzaddnew\=true/gi)?b.replace(/tzaddnew\=true/gi,""):b}).one("load",function(){a.modal("show")})}),$this.undelegate(".tz_control-btn-delete","click").delegate(".tz_control-btn-delete","click",function(){var a=$(this),b=confirm("Press OK to delete section, Cancel to leave"),c=$(this).parents("[data-model-id][data-element_type]").first(),d=c.parents("[data-model-id]").first();$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"}),b&&($.jvcBuilder.remove_mapper_item(),a.parents("[data-model-id]").first().attr("data-element_type")?($.jvcBuilder.remove_mapper_item(c),c.remove()):a.parents("[data-model-id]").eq(1).parent().children().length>1?a.parents("[data-model-id]").first().attr("data-element-item-count")>1?parseInt(a.parents("[data-model-id]").first().attr("data-element-item-count")).each(function(b){c.find("[aria-control="+a.parents("[data-model-id]").first().attr("data-aria-control")+"-"+b+"]").remove(),a.parents("[data-model-id]").first().parent().remove()}):($.jvcBuilder.remove_mapper_item(a.parents("[data-model-id]").first()),a.parents("[data-model-id]").eq(1).remove()):($.jvcBuilder.remove_mapper_item(c),c.remove()),d.find("> .element_wrapper .tz_column_container").first().find(">[data-model-id]").length||(d.addClass("tz_empty-column"),resetToEmptyColumn(d))),new $.jvcBuilder($this,$var)}),$this.undelegate(".tz_control-btn-prepend","click").delegate(".tz_control-btn-prepend","click",function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("destroy").jvc_tooltip({html:!0,container:"body"});var a=$(this).parents("[data-model-id]").first();$.jvcBuilder.model.set("id",a.attr("data-model-id"))}),$this.undelegate(".tz_control-btn-add","click").delegate(".tz_control-btn-add","click",function(){var a=$(this),b=a.parents("[data-model-id]").first().find("[data-model-id][data-aria-control]").first(),c=a.parents("[data-model-id][data-element_type]").first(),d=guid(),e=$.jvcBuilder.createId(c.parent().find(">[data-model-id]").length);if($.jvcBuilder.model.set("model",c),c.attr("data-element-item-count"))parseInt(c.attr("data-element-item-count")).each(function(a){var f=$("#template-jscontent-new-element-"+c.data("element_id")+"-item-"+a).clone();if(f.length){var g=f.html();if(g=$.jvcBuilder.setIDHtml(g,c.parent().find(">[data-model-id]").length,e,!1,!0,a),a!=parseInt(c.attr("data-element-item-count"))-1){if(c.find("[aria-control*=-"+a+"]").length&&c.find("[aria-control*=-"+a+"]").parent().length){g=g.replace(/\[modelid\]\[\/modelid\]/gi,d+"-"+a);var h=$(g);h=$.jvcBuilder.createDataModelIds(h),c.find("[aria-control*=-"+a+"]").parent().append(h)}}else{var i=c.find(">.element_wrapper [data-model-id]").first();if(i.length&&i.parent().length){g=g.replace(/\[modelid\]\[\/modelid\]/gi,d);var h=$(g);h=$.jvcBuilder.createDataModelIds(h),$.jvcBuilder.insert_mapper_item(h.find("[data-model-id][data-aria-control]").first(),b,"",$.jvcBuilder.mapper[b.attr("data-model-id")],!0),i.parent().append(h)}}}}),new $.jvcBuilder($this,$var);else{var f=$(this).parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first();$.jvcBuilder.model.set("id",f.attr("data-model-id"))}$.jvcBuilder.model.reset()}),$this.undelegate(".tz_control-btn-edit","click").delegate(".tz_control-btn-edit","click",function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide").jvc_tooltip("disable");var a=$(this).parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first();$.jvcBuilder.model.set("id",a.attr("data-model-id"))}),$this.undelegate(".tz_control-btn-clone","click").delegate(".tz_control-btn-clone","click",function(){$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("hide").jvc_tooltip("disable");var $el=$(this).parents("[data-model-id]").first(),$elId=$(this).parents("[data-model-id][data-element_type]").first().data("element_id"),$count=null,$guid=guid(),$id=$.jvcBuilder.createId($el.parent().find(">[data-model-id]").length),$i=0;$.jvcBuilder.model.set("model",$el),$el.attr("data-element-item-count")&&($count=parseInt($el.attr("data-element-item-count")));var $data=$.jvcBuilder.mapper[$el.attr("data-model-id")];if($el.attr("data-aria-control")&&$el.attr("data-aria-control").length)$count&&$count.each(function(a){if(a!=$count-1){var b=$("#template-jscontent-new-element-"+$elId+"-item-"+a).clone(!0);b.length&&(b=b.html(),b=b.replace(/\[modelid\]\[\/modelid\]/gi,$guid+"-"+a),b=$.jvcBuilder.setValueExtrafield(b,$data.params),b=$.jvcBuilder.setIDHtml(b,$el.parent().find(">[data-model-id]").length,$id,null,null,a),$el.parents("[data-model-id][data-element_type]").first().find("[aria-control="+$el.attr("data-aria-control")+"-"+a+"]").first().after(b))}else{var c=$el.parents("[data-model-id]").first(),b=$(c).jscontent_htmlTree({jvcBuilder:$.jvcBuilder,parent_element_object:c.parents("[data-model-id][data-element_type],[data-model-id][data-aria-control]").first()});b=$.jvcBuilder.setIDHtml(b,$el.parent().find(">[data-model-id]").length,$id,null,null,a),b=b.replace(/\[modelid\]\[\/modelid\]/gi,$guid),b=$(b),$.jvcBuilder.insert_mapper_item(b.find("[data-model-id][data-aria-control]").first(),"",c.parents("[data-model-id][data-element_type],[data-model-id][data-aria-control]").first(),$data),c.after(b[0])}});else{var $newHtml=$($el).jscontent_htmlTree({jvcBuilder:$.jvcBuilder,parent_element_object:$el.parents("[data-model-id][data-element_type],[data-model-id][data-aria-control]").first()});if($newHtml.match(/(\[parentid[0-9+]?\].*?\[\/parentid[0-9+]?\])/gim)){var $matches=$newHtml.match(/(\[parentid[0-9+]?\].*?\[\/parentid[0-9+]?\])/gim);$.each($matches,function(index,value){var regex="/"+tzaddslashes(value)+"/gi";regex=eval(regex),regex.exec($newHtml)&&($newHtml=$newHtml.replace(regex,uniqid()))})}else if($newHtml.match(/(\[\/parentid[0-9+]?\])/gim)){var $matches=$newHtml.match(/(\[\/parentid[0-9+]?\])/gim);$.each($matches,function(index,value){var regex="/"+tzaddslashes(value)+"/gi";regex=eval(regex),regex.exec($newHtml)&&($newHtml=$newHtml.replace(regex,uniqid()))})}$newHtml=$($newHtml),$el.after($newHtml[0])}$.jvcBuilder.model.reset(),$this.find("[data-toggle~='jvc_tooltip'],.hasTooltip").jvc_tooltip("enable"),new $.jvcBuilder($this,$var)}),$this.undelegate(".tz_empty-container","click").delegate(".tz_empty-container","click",function(){$.jvcBuilder.model.set("id",$(this).parents("[data-model-id]").first().attr("data-model-id"))}),$("#jscontent_toolbar_"+$var.name).undelegate('[data-toggle="jvc_tab"]',"show.bs.jvc_tab").delegate('[data-toggle="jvc_tab"]',"show.bs.jvc_tab",function(){var a=$("#jscontent_content_"+$var.name);if("preview"==$(this).parent().data("button-type")){{var b={};$.jvcBuilder.mapper}if(a.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").length){b={},a.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").each(function(){b[$(this).attr("data-model-id")]=$.jvcBuilder.mapper[$(this).attr("data-model-id")]}),$var.defaults.layout_content[$var.name]=a.children().detach(),$var.ajax_loading_html.length&&$($var.previewer.name).empty().append($var.ajax_loading_html);var c=$.jscontent_shortcode_tree(b,$var.rootPath);$.ajax({type:"POST",url:"index.php?option=com_jvisualcontent&view=shortcodes&task=shortcodes.generate",data:{shortcodes:c}}).done(function(a){a&&$($var.previewer.name).empty().append(a)})}}else $var.defaults.layout_content[$var.name]&&$var.defaults.layout_content[$var.name].appendTo(a),$($var.previewer.name).empty();
new $.jvcBuilder($this,$var)}),document.adminForm.onsubmit=function(){var a=$("#jscontent_content_"+$var.name),b={},c=$.jvcBuilder.mapper;"undefined"!=typeof $var.defaults.layout_content[$var.name]&&$var.defaults.layout_content[$var.name]&&a.append($var.defaults.layout_content[$var.name]),a.length&&a.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").length&&a.find("[data-model-id][data-element_type],[data-model-id][data-aria-control]").each(function(){b[$(this).attr("data-model-id")]=c[$(this).attr("data-model-id")]});var d=$.jscontent_shortcode_tree(b,$var.rootPath);d.length?($("iframe[id*="+$var.name+"]").contents().find("body").empty().focus().html(d),$("#"+$var.name).val(d).html(d)):($("iframe[id*="+$var.name+"]").contents().find("body").empty().focus().html(""),$("#"+$var.name).val(d).html(""))},$.jvcBuilder.prepare_mapper=function(){$.jvcBuilder.mapper&&($.jvcBuilder.mapper=$.each($.jvcBuilder.mapper,function(a,b){if($this.find("[data-model-id="+b.id+"]").length){var c=$this.find("[data-model-id="+b.id+"]").first();c.parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").length&&($.jvcBuilder.mapper[b.id].parent_id=c.parents("[data-model-id][data-aria-control],[data-model-id][data-element_type]").first().attr("data-model-id"))}}))},$var.once_prepare_mapper&&($.jvcBuilder.prepare_mapper(),prepare_row(),$.setActiveLayoutButton(),$var.once_prepare_mapper=!1)},$.jvcBuilder.defaults={name:"",rootPath:"",token:"",layout_content:{},once_prepare_mapper:!1,ajax_loading_html:'<div id="fadingBarsG"><div id="fadingBarsG_1" class="fadingBarsG"></div><div id="fadingBarsG_2" class="fadingBarsG"></div><div id="fadingBarsG_3" class="fadingBarsG"></div><div id="fadingBarsG_4" class="fadingBarsG"></div><div id="fadingBarsG_5" class="fadingBarsG"></div><div id="fadingBarsG_6" class="fadingBarsG"></div><div id="fadingBarsG_7" class="fadingBarsG"></div><div id="fadingBarsG_8" class="fadingBarsG"></div></div>',jInsertEditorText:function(){}},$.jvcBuilder.mapper={},$.jvcBuilder.get=function(a){return $.jvcBuilder[a]?$.jvcBuilder[a]:void 0},$.jvcBuilder.model={id:"",toolbar_position:"",modelRemember:"",model:"",set:function(a,b){a?$.jvcBuilder.model[a]=b:$.jvcBuilder.model.id=b},get:function(a){return $.jvcBuilder.model[a]?$.jvcBuilder.model[a]:""},get_model:function(){return $.jvcBuilder.model.id?$("[data-model-id="+$.jvcBuilder.model.id+"]"):$.jvcBuilder.model.model?$.jvcBuilder.model.model:!1},reset:function(a){a?$.jvcBuilder.model[a]="":$.jvcBuilder.model.id=""}},$.jvcBuilder.preview_add_html=function(a,b){var c=a;$.isPlainObject(a)||(c=$(a)),c.length&&b&&b.length&&c.html(b)},$.jvcBuilder.previewer={"model-id":{parent_id:"",html:""}},$.jvcBuilder.createDataModelIds=function(a,b){var c=a,d=guid(),e="",f="";if("object"!=typeof c&&(c=$(a).clone(!0)),c=$(c),"object"==typeof c&&c.find(".column_toggle")&&c.find(".column_toggle").length&&(f=c.find(".column_toggle")),b){e=$.jvcBuilder.model.get("id");var g=$.jvcBuilder.model.get_model();if(g.attr("data-aria-control"))c.attr("data-aria-control")?c.attr("data-model-id",e):c.find("[data-aria-control]").length&&(c.attr("data-model-id",guid()),c.find("[data-aria-control]").first().attr("data-model-id",e));else if(c.attr("data-element_type"))c.attr("data-model-id",e);else if(c.find("[data-aria-control]").length){var h=g.find("[data-model-id][data-aria-control]");c.find("[data-aria-control]").each(function(a){$(this).attr("data-model-id",h.eq(a).attr("data-model-id"))})}}else c.attr("data-model-id")&&c.attr("data-model-id",d),c.find("[data-model-id]").length&&c.find("[data-model-id]").each(function(){$(this).attr("data-model-id",guid())});return f.length&&f.attr("data-target")&&f.attr("data-target").length&&f.attr("data-target").match(/\[data-model-id=.*?\]/)&&(e?f.attr("data-target",f.attr("data-target").replace(/((\[data-model-id=[\"|\'])(.*?)([\"|\']\]))/,"$2"+e+"$4")):f.attr("data-target",f.attr("data-target").replace(/((\[data-model-id=[\"|\'])(.*?)([\"|\']\]))/,"$2"+d+"$4"))),c},$.fn.jvcBuilder=function(a){return void 0===a&&(a={}),"object"==typeof a?new $.jvcBuilder(this,a):void 0}}(jQuery);